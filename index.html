<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1.0"/>
  <title id="app-title">Global Quiz App</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Inter:400,600&display=swap"/>
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <style>
    :root {
      --primary: #1976d2;
      --accent: #e3f2fd;
      --danger: #e53935;
      --warning: #ffa726;
      --success: #43a047;
      --bg: #fff;
      --text: #212121;
      --card: #fff;
      --funfact-bg: #fffde7;
      --funfact-border: #ffd600;
      --funfact-text: #7c6512;
    }
    body { font-family: "Inter", Arial, sans-serif; background: linear-gradient(135deg, #6ee7b7 0%, #3b82f6 100%); color: var(--text); margin: 0; min-height: 100vh;}
    .header { width: 100%; padding: 1em 1.5em; display: flex; flex-wrap: wrap; justify-content: space-between; align-items: center; background: #fff; box-shadow: 0 2px 8px rgba(25,118,210,0.06); position: sticky; top: 0; z-index: 10;}
    .header h1 { font-size: 1.5em; color: var(--primary); margin: 0;}
    .header-btns { display: flex; gap: 0.7em;}
    .header-btns button, .header-btns select { background: var(--accent); color: var(--primary); border: none; border-radius: 999px; font-weight: 600; font-size: 1em; padding: 0.6em 1.2em; cursor: pointer; transition: background 0.18s, color 0.18s;}
    .header-btns button:hover, .header-btns button:focus-visible { background: var(--primary); color: #fff;}
    .header-btns select { padding: 0.4em 1em; margin: 0 0.2em; font-size: 1em; border-radius: 999px; background: var(--accent); color: var(--primary); border: 1.5px solid #bdbdbd;}
    .header-btns select:focus { outline: 2px solid var(--primary);}
    .splash-screen { position: fixed; inset: 0; background: #fff; display: flex; flex-direction: column; align-items: center; justify-content: center; z-index: 100; font-size: 1.3em;}
    .quiz-container { background: var(--card); border-radius: 18px; box-shadow: 0 8px 40px rgba(60,60,60,0.12); max-width: 420px; margin: 2.5em auto 1.5em auto; padding: 2em 1.2em 2.5em 1.2em; position: relative;}
    .hidden { display: none !important;}
    .score-streak-bar { display: flex; justify-content: space-between; margin-bottom: 1em; font-size: 1.1em; font-weight: 600;}
    .timer-bar { width: 100%; height: 10px; background: #e3e3e3; border-radius: 5px; margin-bottom: 1.2em; position: relative;}
    #timer-bar-fill { height: 100%; background: var(--primary); border-radius: 5px; width: 100%; transition: width 0.3s, background 0.2s;}
    #timer-bar-fill.warning { background: var(--warning);}
    #timer-bar-fill.danger { background: var(--danger);}
    #timer-text { position: absolute; right: 0.5em; top: -1.2em; font-size: 1em; font-weight: 700; color: var(--primary);}
    .question-meta { margin-bottom: 1em; font-size: 1em; color: #444;}
    #question-area img { max-width: 100%; border-radius: 12px; margin-bottom: 1em; box-shadow: 0 2px 10px rgba(25,118,210,0.09);}
    .option-button { display: block; width: 100%; margin: 0.5em 0; text-align: left; border: none; border-radius: 999px; font-size: 1.1em; font-weight: 600; background: var(--accent); color: var(--primary); padding: 0.8em 1.2em; cursor: pointer; transition: background 0.18s, color 0.18s, box-shadow 0.18s, transform 0.08s; box-shadow: 0 1px 4px rgba(25,118,210,0.06);}
    .option-button:hover, .option-button:focus-visible { background: var(--primary); color: #fff;}
    .option-button:active { transform: scale(0.97);}
    .option-button.correct { background: #c8e6c9; color: #256029;}
    .option-button.incorrect { background: #ffcdd2; color: #b71c1c;}
    .option-button:disabled { opacity: 0.7; cursor: not-allowed;}
    .fun-fact { background: var(--funfact-bg); border-left: 5px solid var(--funfact-border); padding: 0.85rem 1.2rem; margin: 1.1rem 0 0.7rem 0; border-radius: 0.7rem; font-size: 1.04rem; color: var(--funfact-text); box-shadow: 0 1px 6px rgba(255,214,0,0.07);}
    .fun-fact.hidden { display: none;}
    .snackbar { position: fixed; left: 50%; bottom: 2em; transform: translateX(-50%); background: var(--primary); color: #fff; padding: 1em 2em; border-radius: 1.5em; font-size: 1em; box-shadow: 0 4px 18px rgba(25,118,210,0.15); opacity: 0; pointer-events: none; transition: opacity 0.3s, bottom 0.3s; z-index: 1000;}
    .snackbar.show { opacity: 1; pointer-events: auto; bottom: 3.5em;}
    .modal { position: fixed; inset: 0; z-index: 200; background: rgba(40,40,40,0.34); display: flex; align-items: center; justify-content: center;}
    .modal.hidden { display: none !important; }
    .modal-content { background: #fff; border-radius: 18px; box-shadow: 0 8px 40px rgba(60,60,60,0.18); padding: 2em 1.2em; min-width: 260px; max-width: 98vw; position: relative;}
    .close-btn { position: absolute; top: 0.7em; right: 1.1em; background: transparent; color: #888; font-size: 1.7em; border: none; border-radius: 50%; cursor: pointer;}
    .close-btn:hover { background: #e57373; color: #fff; }
    #sound-toggle-btn { background: var(--accent); color: var(--primary); font-weight: 600; border: none; border-radius: 999px; padding: 0.45em 1em; font-size: 1em; box-shadow: 0 2px 8px rgba(25,118,210,0.06); gap: 0.4em; transition: background 0.18s, color 0.18s; display: inline-flex; align-items: center;}
    #sound-toggle-btn:hover, #sound-toggle-btn:focus-visible { background: var(--primary); color: #fff;}
    #volume-icon, #mute-icon { font-size: 1.2em; transition: opacity 0.2s;}
    #mute-icon.hidden, #volume-icon.hidden { display: none;}
    .material-icons { font-family: 'Material Icons'; font-style: normal; font-weight: normal; font-size: 24px; line-height: 1; letter-spacing: normal; text-transform: none; display: inline-block; direction: ltr; -webkit-font-feature-settings: 'liga'; -webkit-font-smoothing: antialiased;}
    @media (max-width: 600px) {
      .quiz-container { padding: 1em 0.5em 1em 0.5em; min-width: unset;}
      .header { flex-direction: column; gap: 0.7em; padding: 0.7em 0.5em;}
    }
  </style>
</head>
<body>
  <!-- Header -->
  <header class="header">
    <h1 id="app-title">Global Quiz App</h1>
    <nav class="header-btns">
      <button id="profile-btn" aria-label="Profile"><span class="material-icons">account_circle</span></button>
      <button id="open-settings" aria-label="Settings"><span class="material-icons">settings</span></button>
      <select id="language-selector" aria-label="Select Language">
        <option value="en">English</option>
        <option value="es">Español</option>
        <option value="fr">Français</option>
        <option value="ml">മലയാളം</option>
      </select>
      <button id="sound-toggle-btn" aria-label="Sound" aria-pressed="false">
        <span id="volume-icon" class="material-icons">volume_up</span>
        <span id="mute-icon" class="material-icons hidden">volume_off</span>
      </button>
    </nav>
  </header>

  <!-- Splash Screen -->
  <div class="splash-screen" id="splash-screen">
    <span class="material-icons" style="font-size:3em;color:#1976d2;">quiz</span>
    <div>Loading...</div>
  </div>

  <!-- Start Screen -->
  <main id="start-screen" class="quiz-container hidden">
    <h2 id="welcome-title">Welcome!</h2>
    <div id="welcome-desc" style="margin-bottom:2em;">Test your knowledge with global quizzes.<br>Ready to begin?</div>
    <button id="start-quiz-btn" class="option-button" style="width:100%;margin-bottom:1em;">Start Quiz</button>
    <button id="start-daily-btn" class="option-button" style="width:100%;">Start Daily Quiz</button>
  </main>

  <!-- Quiz Content -->
  <section id="quiz-content" class="quiz-container hidden">
    <div class="score-streak-bar">
      <span id="score-label">Score: <span id="score">0</span></span>
      <span id="streak-label">Streak: <span id="streak">0</span></span>
    </div>
    <div class="timer-bar">
      <div id="timer-bar-fill"></div>
      <span id="timer-text"></span>
    </div>
    <div class="question-meta">
      <span id="current-question">1</span> <span id="of">of</span> <span id="total-questions">3</span>
    </div>
    <div id="question-area"></div>
    <div id="fun-fact-box" class="fun-fact hidden"></div>
  </section>

  <!-- Snackbar/Toast -->
  <div id="snackbar" class="snackbar hidden"></div>

  <!-- Profile Modal -->
  <div id="profile-modal" class="modal hidden" tabindex="-1" aria-modal="true" role="dialog">
    <div class="modal-content">
      <button class="close-btn" id="close-profile-modal" aria-label="Close"><span class="material-icons">close</span></button>
      <h2 id="profile-modal-title">Profile</h2>
      <div>
        <label>Name: <input type="text" id="profile-name" /></label>
      </div>
      <button id="save-profile-btn" class="option-button">Save</button>
    </div>
  </div>

  <!-- Settings Modal -->
  <div id="settings-modal" class="modal hidden" tabindex="-1" aria-modal="true" role="dialog">
    <div class="modal-content">
      <button class="close-btn" id="close-settings-modal" aria-label="Close"><span class="material-icons">close</span></button>
      <h2 id="settings-modal-title">Settings</h2>
      <label for="language-setting">Language:</label>
      <select id="language-setting">
        <option value="en">English</option>
        <option value="es">Español</option>
        <option value="fr">Français</option>
        <option value="ml">മലയാളം</option>
      </select>
    </div>
  </div>

  <!-- Sound Effects -->
  <audio id="correct-sound" src="https://cdn.pixabay.com/audio/2022/03/15/audio_115b9b3b3b.mp3"></audio>
  <audio id="wrong-sound" src="https://cdn.pixabay.com/audio/2022/03/15/audio_11b3b3b3b.mp3"></audio>

  <script>
    // ===== Embedded Strings and Questions =====
    const STRINGS = {
      "en": {
        "appTitle": "Global Quiz App",
        "welcomeTitle": "Welcome!",
        "welcomeDesc": "Test your knowledge with global quizzes.<br>Ready to begin?",
        "startQuiz": "Start Quiz",
        "startDailyQuiz": "Start Daily Quiz",
        "score": "Score",
        "streak": "Streak",
        "of": "of",
        "profile": "Profile",
        "settings": "Settings",
        "quizQuestions": [
          {
            "id": 1,
            "question": "What is a group of lions called?",
            "options": ["Pride", "Flock", "School", "Pack"],
            "answer": 0,
            "image": "https://images.unsplash.com/photo-1506744038136-46273834b3fb?auto=format&fit=crop&w=400&q=80",
            "explanation": "A group of lions is called a pride.",
            "funFact": "Lion prides are usually made up of related females and their offspring, plus a small number of adult males.",
            "difficulty": "easy",
            "topic": "mammals"
          },
          {
            "id": 2,
            "question": "What is a group of crows called?",
            "options": ["Murder", "Gaggle", "Pod", "Swarm"],
            "answer": 0,
            "image": "https://images.unsplash.com/photo-1464983953574-0892a716854b?auto=format&fit=crop&w=400&q=80",
            "explanation": "A group of crows is called a murder.",
            "funFact": "Crows are known for their intelligence and can use tools and solve complex problems.",
            "difficulty": "medium",
            "topic": "birds"
          },
          {
            "id": 3,
            "question": "What is a group of elephants called?",
            "options": ["Herd", "Pod", "Pack", "Troop"],
            "answer": 0,
            "image": "https://images.unsplash.com/photo-1465101046530-73398c7f28ca?auto=format&fit=crop&w=400&q=80",
            "explanation": "A group of elephants is called a herd.",
            "funFact": "Elephant herds are led by the oldest female, known as the matriarch.",
            "difficulty": "easy",
            "topic": "mammals"
          }
        ]
      },
      "es": {
        "appTitle": "Quiz Global",
        "welcomeTitle": "¡Bienvenido!",
        "welcomeDesc": "Pon a prueba tus conocimientos con cuestionarios globales.<br>¿Listo para empezar?",
        "startQuiz": "Comenzar quiz",
        "startDailyQuiz": "Comenzar desafío diario",
        "score": "Puntaje",
        "streak": "Racha",
        "of": "de",
        "profile": "Perfil",
        "settings": "Configuración",
        "quizQuestions": [
          {
            "id": 1,
            "question": "¿Cómo se llama un grupo de leones?",
            "options": ["Manada", "Bandada", "Escuela", "Manojo"],
            "answer": 0,
            "image": "https://images.unsplash.com/photo-1506744038136-46273834b3fb?auto=format&fit=crop&w=400&q=80",
            "explanation": "Un grupo de leones se llama manada.",
            "funFact": "Las manadas de leones suelen estar formadas por hembras emparentadas y sus crías, además de algunos machos adultos.",
            "difficulty": "easy",
            "topic": "mamíferos"
          },
          {
            "id": 2,
            "question": "¿Cómo se llama un grupo de cuervos?",
            "options": ["Parvada", "Bandada", "Pod", "Enjambre"],
            "answer": 0,
            "image": "https://images.unsplash.com/photo-1464983953574-0892a716854b?auto=format&fit=crop&w=400&q=80",
            "explanation": "Un grupo de cuervos se llama parvada.",
            "funFact": "Los cuervos son conocidos por su inteligencia y su capacidad para usar herramientas y resolver problemas complejos.",
            "difficulty": "medium",
            "topic": "aves"
          },
          {
            "id": 3,
            "question": "¿Cómo se llama un grupo de elefantes?",
            "options": ["Manada", "Pod", "Manojo", "Tropa"],
            "answer": 0,
            "image": "https://images.unsplash.com/photo-1465101046530-73398c7f28ca?auto=format&fit=crop&w=400&q=80",
            "explanation": "Un grupo de elefantes se llama manada.",
            "funFact": "Las manadas de elefantes son lideradas por la hembra más vieja, llamada matriarca.",
            "difficulty": "easy",
            "topic": "mamíferos"
          }
        ]
      },
      "fr": {
        "appTitle": "Quiz Mondial",
        "welcomeTitle": "Bienvenue !",
        "welcomeDesc": "Testez vos connaissances avec des quiz mondiaux.<br>Prêt à commencer ?",
        "startQuiz": "Commencer le quiz",
        "startDailyQuiz": "Commencer le défi du jour",
        "score": "Score",
        "streak": "Série",
        "of": "sur",
        "profile": "Profil",
        "settings": "Paramètres",
        "quizQuestions": [
          {
            "id": 1,
            "question": "Comment appelle-t-on un groupe de lions ?",
            "options": ["Troupe", "Vol", "École", "Meute"],
            "answer": 0,
            "image": "https://images.unsplash.com/photo-1506744038136-46273834b3fb?auto=format&fit=crop&w=400&q=80",
            "explanation": "Un groupe de lions s'appelle une troupe.",
            "funFact": "Les troupes de lions sont généralement composées de femelles apparentées et de leurs petits, ainsi que de quelques mâles adultes.",
            "difficulty": "easy",
            "topic": "mammifères"
          },
          {
            "id": 2,
            "question": "Comment appelle-t-on un groupe de corbeaux ?",
            "options": ["Volée", "Bande", "Pod", "Essaim"],
            "answer": 0,
            "image": "https://images.unsplash.com/photo-1464983953574-0892a716854b?auto=format&fit=crop&w=400&q=80",
            "explanation": "Un groupe de corbeaux s'appelle une volée.",
            "funFact": "Les corbeaux sont connus pour leur intelligence et leur capacité à utiliser des outils et à résoudre des problèmes complexes.",
            "difficulty": "medium",
            "topic": "oiseaux"
          },
          {
            "id": 3,
            "question": "Comment appelle-t-on un groupe d'éléphants ?",
            "options": ["Troupeau", "Pod", "Meute", "Bande"],
            "answer": 0,
            "image": "https://images.unsplash.com/photo-1465101046530-73398c7f28ca?auto=format&fit=crop&w=400&q=80",
            "explanation": "Un groupe d'éléphants s'appelle un troupeau.",
            "funFact": "Les troupeaux d'éléphants sont dirigés par la femelle la plus âgée, appelée matriarche.",
            "difficulty": "easy",
            "topic": "mammifères"
          }
        ]
      },
      "ml": {
        "appTitle": "ഗ്ലോബൽ ക്വിസ് ആപ്പ്",
        "welcomeTitle": "സ്വാഗതം!",
        "welcomeDesc": "ലോകവ്യാപകമായ ക്വിസുകളിലൂടെ നിങ്ങളുടെ അറിവ് പരീക്ഷിക്കുക.<br>തയ്യാറാണോ?",
        "startQuiz": "ക്വിസ് ആരംഭിക്കുക",
        "startDailyQuiz": "ദൈനംദിന ക്വിസ് ആരംഭിക്കുക",
        "score": "സ്കോർ",
        "streak": "സ്ട്രീക്ക്",
        "of": "ഇൽ",
        "profile": "പ്രൊഫൈൽ",
        "settings": "ക്രമീകരണങ്ങൾ",
        "quizQuestions": [
          {
            "id": 1,
            "question": "സിംഹങ്ങളുടെ കൂട്ടത്തെ എന്താണ് വിളിക്കുന്നത്?",
            "options": ["പ്രൈഡ്", "ഫ്ലോക്ക്", "സ്കൂൾ", "പാക്ക്"],
            "answer": 0,
            "image": "https://images.unsplash.com/photo-1506744038136-46273834b3fb?auto=format&fit=crop&w=400&q=80",
            "explanation": "സിംഹങ്ങളുടെ കൂട്ടത്തെ പ്രൈഡ് എന്ന് വിളിക്കുന്നു.",
            "funFact": "പ്രൈഡിൽ സാധാരണയായി ബന്ധമുള്ള പെൺ സിംഹങ്ങളും അവരുടെ കുഞ്ഞുങ്ങളും കുറച്ച് പുരുഷ സിംഹങ്ങളും ഉണ്ടാകും.",
            "difficulty": "easy",
            "topic": "മൃഗങ്ങൾ"
          },
          {
            "id": 2,
            "question": "കാക്കകളുടെ കൂട്ടത്തെ എന്താണ് വിളിക്കുന്നത്?",
            "options": ["മർഡർ", "ഗാഗിൾ", "പോഡ്", "സ്വാർം"],
            "answer": 0,
            "image": "https://images.unsplash.com/photo-1464983953574-0892a716854b?auto=format&fit=crop&w=400&q=80",
            "explanation": "കാക്കകളുടെ കൂട്ടത്തെ മർഡർ എന്ന് വിളിക്കുന്നു.",
            "funFact": "കാക്കകൾ വളരെ ബുദ്ധിമുട്ടുള്ളവയാണ്; അവയ്ക്ക് ഉപകരണങ്ങൾ ഉപയോഗിക്കാനും പ്രശ്നങ്ങൾ പരിഹരിക്കാനും കഴിയും.",
            "difficulty": "medium",
            "topic": "പക്ഷികൾ"
          },
          {
            "id": 3,
            "question": "ആനകളുടെ കൂട്ടത്തെ എന്താണ് വിളിക്കുന്നത്?",
            "options": ["ഹേർഡ്", "പോഡ്", "പാക്ക്", "ട്രൂപ്പ്"],
            "answer": 0,
            "image": "https://images.unsplash.com/photo-1465101046530-73398c7f28ca?auto=format&fit=crop&w=400&q=80",
            "explanation": "ആനകളുടെ കൂട്ടത്തെ ഹേർഡ് എന്ന് വിളിക്കുന്നു.",
            "funFact": "ആനകളുടെ കൂട്ടത്തിന് നേതൃത്വം നൽകുന്നത് ഏറ്റവും പ്രായം കൂടിയ പെൺ ആനയാണ്, അവളെ 'മാട്രിയാർക്ക്' എന്ന് വിളിക്കുന്നു.",
            "difficulty": "easy",
            "topic": "മൃഗങ്ങൾ"
          }
        ]
      }
    };

    // ===== Utility Functions =====
    function $(id) { return document.getElementById(id); }
    function show(el) { el && el.classList.remove('hidden'); }
    function hide(el) { el && el.classList.add('hidden'); }
    function setText(id, value) { if ($(id)) $(id).innerHTML = value; }

    // ===== Global State =====
    let LANG = 'en';
    let quizSet = [];
    let current = 0, score = 0, streak = 0, timer = null;
    let isDaily = false;
    let quizInProgress = false;
    let isMuted = false;
    let profileName = localStorage.getItem('profileName') || '';

    // ===== Initialization =====
    document.addEventListener('DOMContentLoaded', () => {
      LANG = localStorage.getItem('lang') || 'en';
      if (!STRINGS[LANG]) LANG = 'en';
      updateAllStrings();
      setupEventListeners();
      if (profileName) $('profile-name').value = profileName;
      hide($('splash-screen'));
      show($('start-screen'));
      hide($('quiz-content'));
    });

    // ===== Language Switching =====
    function updateAllStrings() {
      if (!STRINGS[LANG]) LANG = 'en';
      const S = STRINGS[LANG];
      setText('app-title', S.appTitle);
      setText('welcome-title', S.welcomeTitle);
      setText('welcome-desc', S.welcomeDesc);
      setText('start-quiz-btn', S.sta